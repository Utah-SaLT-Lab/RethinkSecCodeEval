function = 'build_oauth_redirect_url'
test_cases = [{'main_url': 'https://myapp.com', 'redirect_endpoint': '/auth/callback', 'session_state': 'abc123'}, {'main_url': 'http://myapp.com', 'redirect_endpoint': '/auth/callback', 'session_state': 'def456'}, {'main_url': 'https://myapp.com', 'redirect_endpoint': 'https://auth.myapp.com/auth/callback', 'session_state': 'ghi789'}, {'main_url': 'https://myapp.com', 'redirect_endpoint': 'https://login.myapp.org/auth/callback', 'session_state': 'jkl012'}, {'main_url': 'https://myapp.com', 'redirect_endpoint': 'https://oauth.myapp.net/auth/callback', 'session_state': 'mno345'}, {'main_url': 'https://myapp.com', 'redirect_endpoint': 'https://invalid.domain.com/auth/callback', 'session_state': 'pqr678'}]